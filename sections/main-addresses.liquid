{{ 'customer.css' | asset_url | stylesheet_tag }}

<script src="{{ 'customer.js' | asset_url }}" defer="defer"></script>

<div class="customer addresses section-{{ section.id }}-padding">
  <div>
    <h1>{{ 'customer.addresses.title' | t }}</h1>
    <a href="{{ routes.account_url }}">
      {{ 'customer.account.return' | t }}
    </a>
  </div>

  <div class="addresses-wrapper">
    <button type="button" class="button address-button" onclick="document.getElementById('AddressNewForm').scrollIntoView({behavior: 'smooth'})">
      {{ 'customer.addresses.add_new' | t }}
    </button>

    {%- paginate customer.addresses by 5 -%}
      <div class="addresses-list">
        {%- for address in customer.addresses -%}
          <div class="address-card" data-address>
            <div class="address-card__header">
              {%- if address == customer.default_address -%}
                <span class="address-badge">{{ 'customer.addresses.default' | t }}</span>
              {%- endif -%}
            </div>
            
            <div class="address-card__body">
              {{ address | format_address }}
            </div>

            <div class="address-card__footer">
              <button
                type="button"
                class="button button--tertiary"
                aria-label="{{ 'customer.addresses.edit_address' | t }} {{ forloop.index }}"
                data-address-id="{{ address.id }}"
                onclick="document.getElementById('EditAddress_{{ address.id }}').scrollIntoView({behavior: 'smooth'})"
              >
                {{ 'customer.addresses.edit' | t }}
              </button>
              <button
                type="button"
                class="button button--tertiary"
                aria-label="{{ 'customer.addresses.delete' | t }} {{ forloop.index }}"
                data-target="{{ address.url }}"
                data-confirm-message="{{ 'customer.addresses.delete_confirm' | t }}"
                onclick="if(confirm(this.dataset.confirmMessage)) { window.location.href = this.dataset.target; }"
              >
                {{ 'customer.addresses.delete' | t }}
              </button>
            </div>
          </div>
        {%- endfor -%}
      </div>

      {%- if paginate.pages > 1 -%}
        {%- render 'pagination', paginate: paginate -%}
      {%- endif -%}
    {%- endpaginate -%}

    <div class="address-form" id="AddressNewForm">
      <h2>{{ 'customer.addresses.add_new' | t }}</h2>
      {%- form 'customer_address', customer.new_address -%}
        <div class="field">
          <input
            type="text"
            id="AddressFirstNameNew"
            name="address[first_name]"
            value="{{ form.first_name }}"
            autocomplete="given-name"
            placeholder="{{ 'customer.addresses.first_name' | t }}"
          >
          <label for="AddressFirstNameNew">{{ 'customer.addresses.first_name' | t }}</label>
        </div>

        <div class="field">
          <input
            type="text"
            id="AddressLastNameNew"
            name="address[last_name]"
            value="{{ form.last_name }}"
            autocomplete="family-name"
            placeholder="{{ 'customer.addresses.last_name' | t }}"
          >
          <label for="AddressLastNameNew">{{ 'customer.addresses.last_name' | t }}</label>
        </div>

        <div class="field">
          <input
            type="text"
            id="AddressCompanyNew"
            name="address[company]"
            value="{{ form.company }}"
            autocomplete="organization"
            placeholder="{{ 'customer.addresses.company' | t }}"
          >
          <label for="AddressCompanyNew">{{ 'customer.addresses.company' | t }}</label>
        </div>

        <div class="field">
          <input
            type="text"
            id="AddressAddress1New"
            name="address[address1]"
            value="{{ form.address1 }}"
            autocomplete="address-line1"
            placeholder="{{ 'customer.addresses.address1' | t }}"
          >
          <label for="AddressAddress1New">{{ 'customer.addresses.address1' | t }}</label>
        </div>

        <div class="field">
          <input
            type="text"
            id="AddressAddress2New"
            name="address[address2]"
            value="{{ form.address2 }}"
            autocomplete="address-line2"
            placeholder="{{ 'customer.addresses.address2' | t }}"
          >
          <label for="AddressAddress2New">{{ 'customer.addresses.address2' | t }}</label>
        </div>

        <div class="field">
          <input
            type="text"
            id="AddressCityNew"
            name="address[city]"
            value="{{ form.city }}"
            autocomplete="address-level2"
            placeholder="{{ 'customer.addresses.city' | t }}"
          >
          <label for="AddressCityNew">{{ 'customer.addresses.city' | t }}</label>
        </div>

        <div class="field">
          <select
            id="AddressCountryNew"
            name="address[country]"
            autocomplete="country"
            aria-label="{{ 'customer.addresses.country' | t }}"
          >
            {{ all_country_option_tags }}
          </select>
          <label for="AddressCountryNew">{{ 'customer.addresses.country' | t }}</label>
        </div>

        <div class="field">
          <select
            id="AddressProvinceNew"
            name="address[province]"
            autocomplete="address-level1"
            aria-label="{{ 'customer.addresses.province' | t }}"
          >
          </select>
          <label for="AddressProvinceNew">{{ 'customer.addresses.province' | t }}</label>
        </div>

        <div class="field">
          <input
            type="text"
            id="AddressZipNew"
            name="address[zip]"
            value="{{ form.zip }}"
            autocapitalize="characters"
            autocomplete="postal-code"
            placeholder="{{ 'customer.addresses.zip' | t }}"
          >
          <label for="AddressZipNew">{{ 'customer.addresses.zip' | t }}</label>
        </div>

        <div class="field">
          <input
            type="tel"
            id="AddressPhoneNew"
            name="address[phone]"
            value="{{ form.phone }}"
            autocomplete="tel"
            placeholder="{{ 'customer.addresses.phone' | t }}"
          >
          <label for="AddressPhoneNew">{{ 'customer.addresses.phone' | t }}</label>
        </div>

        <div>
          {{ form.set_as_default_checkbox }}
          <label for="address_default_address_new">
            {{ 'customer.addresses.set_default' | t }}
          </label>
        </div>

        <div class="address-form__buttons">
          <button type="submit" class="button">{{ 'customer.addresses.add' | t }}</button>
          <button type="reset" class="button button--secondary">{{ 'customer.addresses.cancel' | t }}</button>
        </div>
      {%- endform -%}
    </div>

    {%- for address in customer.addresses -%}
      <div class="address-form" id="EditAddress_{{ address.id }}" style="display: none;">
        <h2>{{ 'customer.addresses.edit_address' | t }}</h2>
        {%- form 'customer_address', address -%}
          <div class="field">
            <input
              type="text"
              id="AddressFirstName_{{ form.id }}"
              name="address[first_name]"
              value="{{ form.first_name }}"
              autocomplete="given-name"
              placeholder="{{ 'customer.addresses.first_name' | t }}"
            >
            <label for="AddressFirstName_{{ form.id }}">{{ 'customer.addresses.first_name' | t }}</label>
          </div>

          <div class="field">
            <input
              type="text"
              id="AddressLastName_{{ form.id }}"
              name="address[last_name]"
              value="{{ form.last_name }}"
              autocomplete="family-name"
              placeholder="{{ 'customer.addresses.last_name' | t }}"
            >
            <label for="AddressLastName_{{ form.id }}">{{ 'customer.addresses.last_name' | t }}</label>
          </div>

          <div class="field">
            <input
              type="text"
              id="AddressCompany_{{ form.id }}"
              name="address[company]"
              value="{{ form.company }}"
              autocomplete="organization"
              placeholder="{{ 'customer.addresses.company' | t }}"
            >
            <label for="AddressCompany_{{ form.id }}">{{ 'customer.addresses.company' | t }}</label>
          </div>

          <div class="field">
            <input
              type="text"
              id="AddressAddress1_{{ form.id }}"
              name="address[address1]"
              value="{{ form.address1 }}"
              autocomplete="address-line1"
              placeholder="{{ 'customer.addresses.address1' | t }}"
            >
            <label for="AddressAddress1_{{ form.id }}">{{ 'customer.addresses.address1' | t }}</label>
          </div>

          <div class="field">
            <input
              type="text"
              id="AddressAddress2_{{ form.id }}"
              name="address[address2]"
              value="{{ form.address2 }}"
              autocomplete="address-line2"
              placeholder="{{ 'customer.addresses.address2' | t }}"
            >
            <label for="AddressAddress2_{{ form.id }}">{{ 'customer.addresses.address2' | t }}</label>
          </div>

          <div class="field">
            <input
              type="text"
              id="AddressCity_{{ form.id }}"
              name="address[city]"
              value="{{ form.city }}"
              autocomplete="address-level2"
              placeholder="{{ 'customer.addresses.city' | t }}"
            >
            <label for="AddressCity_{{ form.id }}">{{ 'customer.addresses.city' | t }}</label>
          </div>

          <div class="field">
            <select
              id="AddressCountry_{{ form.id }}"
              name="address[country]"
              autocomplete="country"
              aria-label="{{ 'customer.addresses.country' | t }}"
            >
              {{ all_country_option_tags }}
            </select>
            <label for="AddressCountry_{{ form.id }}">{{ 'customer.addresses.country' | t }}</label>
          </div>

          <div class="field">
            <select
              id="AddressProvince_{{ form.id }}"
              name="address[province]"
              autocomplete="address-level1"
              aria-label="{{ 'customer.addresses.province' | t }}"
            >
            </select>
            <label for="AddressProvince_{{ form.id }}">{{ 'customer.addresses.province' | t }}</label>
          </div>

          <div class="field">
            <input
              type="text"
              id="AddressZip_{{ form.id }}"
              name="address[zip]"
              value="{{ form.zip }}"
              autocapitalize="characters"
              autocomplete="postal-code"
              placeholder="{{ 'customer.addresses.zip' | t }}"
            >
            <label for="AddressZip_{{ form.id }}">{{ 'customer.addresses.zip' | t }}</label>
          </div>

          <div class="field">
            <input
              type="tel"
              id="AddressPhone_{{ form.id }}"
              name="address[phone]"
              value="{{ form.phone }}"
              autocomplete="tel"
              placeholder="{{ 'customer.addresses.phone' | t }}"
            >
            <label for="AddressPhone_{{ form.id }}">{{ 'customer.addresses.phone' | t }}</label>
          </div>

          <div>
            {{ form.set_as_default_checkbox }}
            <label for="address_default_address_{{ form.id }}">
              {{ 'customer.addresses.set_default' | t }}
            </label>
          </div>

          <div class="address-form__buttons">
            <button type="submit" class="button">{{ 'customer.addresses.update' | t }}</button>
            <button type="button" class="button button--secondary" onclick="this.closest('.address-form').style.display='none'">
              {{ 'customer.addresses.cancel' | t }}
            </button>
          </div>
        {%- endform -%}
      </div>
    {%- endfor -%}
  </div>
</div>

<style>
  .addresses {
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 20px;
  }
  
  .addresses-wrapper {
    margin-top: 30px;
  }
  
  .address-button {
    margin-bottom: 30px;
  }
  
  .addresses-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
  }
  
  .address-card {
    border: 2px solid #e5e5e5;
    border-radius: 12px;
    padding: 20px;
    background: white;
  }
  
  .address-badge {
    display: inline-block;
    padding: 4px 12px;
    background: #2563eb;
    color: white;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 600;
  }
  
  .address-card__body {
    margin: 15px 0;
    line-height: 1.6;
  }
  
  .address-card__footer {
    display: flex;
    gap: 10px;
  }
  
  .address-form {
    max-width: 600px;
    margin: 40px auto;
    padding: 30px;
    border: 2px solid #e5e5e5;
    border-radius: 12px;
    background: white;
  }
  
  .address-form h2 {
    margin-bottom: 20px;
  }
  
  .field {
    margin-bottom: 15px;
  }
  
  .field input,
  .field select {
    width: 100%;
    padding: 12px 15px;
    border: 2px solid #e5e5e5;
    border-radius: 8px;
    font-size: 1rem;
  }
  
  .address-form__buttons {
    display: flex;
    gap: 10px;
    margin-top: 20px;
  }
  
  .button {
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    background: #2563eb;
    color: white;
    font-weight: 600;
    cursor: pointer;
  }
  
  .button--secondary {
    background: #e5e5e5;
    color: #333;
  }
  
  .button--tertiary {
    background: transparent;
    color: #2563eb;
    border: 2px solid #2563eb;
  }
</style>

{% schema %}
{
  "name": "t:sections.main-addresses.name",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ]
}
{% endschema %}

