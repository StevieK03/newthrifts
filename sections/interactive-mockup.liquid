{% comment %}
Enhanced Interactive Product Mockup
- Dynamic rendering with custom text from customizer
- Multiple views (Front, Back, Hanging, Person models)
- Real-time design updates
- Integration with existing customizer
- Printify-style professional mockup system
- Reverted to clean version
{% endcomment %}

<section id="nt-mockup-{{ section.id }}" class="nt-mockup" style="padding: 60px 0; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);">
  <div class="container">
    
    <!-- Section Header -->
    <div class="mockup-header" style="text-align: center; margin-bottom: 40px;">
      <h2 style="font-family: 'Bebas Neue', sans-serif; font-size: 42px; margin: 0 0 16px 0; background: linear-gradient(45deg, #27e1c1, #ff4fa3); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
        ğŸš€ Enhanced Live Design Preview
      </h2>
      <p style="font-size: 18px; color: #cbd5e1; margin: 0; max-width: 600px; margin: 0 auto;">
        See your custom design come to life with our professional mockup system. Now with 3D rotation, real-time editing, design validation, and advanced customization tools.
      </p>
    </div>

    <div class="nt-mockup__inner" style="display: grid; gap: 20px;">
      
      <!-- Enhanced Controls -->
      <div class="nt-mockup__controls" style="display: flex; flex-wrap: wrap; gap: 20px; align-items: center; justify-content: center; background: #1e293b; padding: 20px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); border: 1px solid #334155;">
        
        <!-- View Controls -->
        <div class="nt-mockup__group">
          <span class="nt-mockup__label" style="font-weight: 600; font-size: 14px; color: #f8fafc; margin-right: 12px;">View</span>
          <div class="nt-mockup__buttons" role="tablist" aria-label="Mockup view" style="display: flex; gap: 8px;">
            <button class="nt-btn nt-btn--view is-active" data-view="front" aria-selected="true" style="padding: 8px 16px; border: 2px solid #27e1c1; background: #27e1c1; color: white; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              ğŸ‘• Front
            </button>
            <button class="nt-btn nt-btn--view" data-view="back" aria-selected="false" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              ğŸ‘• Back
            </button>
            <button class="nt-btn nt-btn--view" data-view="hanging" aria-selected="false" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              ğŸ·ï¸ Hanging
            </button>
            <button class="nt-btn nt-btn--view" data-view="person1" aria-selected="false" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              ğŸ‘¤ Model 1
            </button>
            <button class="nt-btn nt-btn--view" data-view="person2" aria-selected="false" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              ğŸ‘¤ Model 2
            </button>
          </div>
        </div>

        <!-- Color Controls -->
        <div class="nt-mockup__group">
          <span class="nt-mockup__label" style="font-weight: 600; font-size: 14px; color: #f8fafc; margin-right: 12px;">Color</span>
          <div class="nt-mockup__buttons" role="tablist" aria-label="Shirt color" style="display: flex; gap: 8px;">
            <button class="nt-btn nt-btn--color is-active" data-color="white" aria-selected="true" style="padding: 8px 16px; border: 2px solid #27e1c1; background: #27e1c1; color: white; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              âšª White
            </button>
            <button class="nt-btn nt-btn--color" data-color="black" aria-selected="false" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              âš« Black
            </button>
            <button class="nt-btn nt-btn--color" data-color="pink" aria-selected="false" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              ğŸ©· Pink
            </button>
            <button class="nt-btn nt-btn--color" data-color="blue" aria-selected="false" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              ğŸ”µ Blue
            </button>
          </div>
        </div>

        <!-- Enhanced 3D Controls -->
        <div class="nt-mockup__group" style="background: linear-gradient(135deg, #334155, #475569); padding: 16px; border-radius: 12px; border: 1px solid #475569;">
          <span class="nt-mockup__label" style="font-weight: 600; font-size: 14px; color: #f8fafc; margin-right: 12px;">ğŸ¯ 3D Controls</span>
          <div class="nt-mockup__buttons" style="display: flex; gap: 8px; flex-wrap: wrap;">
            <button class="nt-btn nt-btn--3d" id="nt-3d-rotate-{{ section.id }}" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              ğŸ”„ 3D Rotate
            </button>
            <button class="nt-btn nt-btn--zoom" id="nt-zoom-{{ section.id }}" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              ğŸ” Zoom
            </button>
            <button class="nt-btn nt-btn--validate" id="nt-validate-{{ section.id }}" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              âœ… Validate
            </button>
            <button class="nt-btn nt-btn--reset" id="nt-reset-{{ section.id }}" style="padding: 8px 16px; border: 2px solid #e2e8f0; background: white; color: #64748b; border-radius: 20px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease;">
              ğŸ”„ Reset
            </button>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="nt-mockup__group">
          <div class="upload-section" style="display: flex; flex-direction: column; gap: 8px; align-items: center;">
            <button class="nt-btn nt-btn--upload" id="nt-upload-{{ section.id }}" style="padding: 10px 20px; background: linear-gradient(45deg, #f59e0b, #d97706); color: white; border: none; border-radius: 25px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; position: relative; overflow: hidden;">
              ğŸ“ Upload Your Design
              <input type="file" id="nt-file-input-{{ section.id }}" accept=".png,.jpg,.jpeg,.svg,.pdf,.ai,.psd" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer;">
            </button>
            
            <div class="file-info" style="display: flex; gap: 12px; align-items: center; font-size: 12px; color: #6b7280;">
              <span>ğŸ“„ Accepts:</span>
              <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                <span class="file-type" style="background: #e5e7eb; padding: 2px 6px; border-radius: 4px; font-size: 11px;">PNG</span>
                <span class="file-type" style="background: #e5e7eb; padding: 2px 6px; border-radius: 4px; font-size: 11px;">JPG</span>
                <span class="file-type" style="background: #e5e7eb; padding: 2px 6px; border-radius: 4px; font-size: 11px;">SVG</span>
                <span class="file-type" style="background: #e5e7eb; padding: 2px 6px; border-radius: 4px; font-size: 11px;">PDF</span>
              </div>
              <button class="help-link" id="nt-help-{{ section.id }}" style="background: none; border: none; color: #3b82f6; cursor: pointer; font-size: 11px; text-decoration: underline;">
                â„¹ï¸ Help
              </button>
            </div>
          </div>
          
          {% if section.settings.allow_download %}
          <button class="nt-btn nt-btn--primary" id="nt-download-{{ section.id }}" style="padding: 10px 20px; background: linear-gradient(45deg, #10b981, #059669); color: white; border: none; border-radius: 25px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-top: 16px;">
            ğŸ“¥ Download Mockup
          </button>
          {% endif %}
          
          <button class="nt-btn nt-btn--secondary" id="nt-edit-{{ section.id }}" style="padding: 10px 20px; background: linear-gradient(45deg, #8b5cf6, #a855f7); color: white; border: none; border-radius: 25px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-top: 16px;">
            âœï¸ Edit Design
          </button>
          
          <button class="nt-btn nt-btn--danger" id="nt-remove-{{ section.id }}" style="padding: 10px 20px; background: linear-gradient(45deg, #ef4444, #dc2626); color: white; border: none; border-radius: 25px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: none; margin-top: 16px;">
            ğŸ—‘ï¸ Remove Design
          </button>
        </div>
      </div>

      <!-- Advanced Placement Controls -->
      <div id="nt-placement-controls-{{ section.id }}" class="nt-placement-controls" style="display: block; background: white; padding: 20px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin: 10px 0 40px 0;">
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
          <span style="font-weight: 600; font-size: 16px; color: #374151;">ğŸ¯ Precise Placement Controls</span>
          <button id="nt-auto-equidistant-{{ section.id }}" style="padding: 6px 12px; background: linear-gradient(45deg, #8b5cf6, #7c3aed); color: white; border: none; border-radius: 8px; font-size: 12px; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 4px;">
            âš–ï¸ Auto-Equidistant
          </button>
          <button id="nt-reset-placement-{{ section.id }}" style="padding: 6px 12px; background: #f3f4f6; color: #6b7280; border: 1px solid #d1d5db; border-radius: 8px; font-size: 12px; cursor: pointer;">
            ğŸ”„ Reset
          </button>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
          <!-- Top Position -->
          <div class="placement-slider">
            <label style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; color: #374151;">
              <span>ğŸ“ Top Position</span>
              <span id="nt-top-val-{{ section.id }}" style="font-weight: 600; color: #27e1c1;">{{ section.settings.overlay_top }}%</span>
            </label>
            <input type="range" id="nt-top-{{ section.id }}" min="0" max="90" step="0.5" value="{{ section.settings.overlay_top }}" style="width: 100%; height: 6px; background: #e5e7eb; border-radius: 3px; outline: none; cursor: pointer;">
          </div>

          <!-- Left Position -->
          <div class="placement-slider">
            <label style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; color: #374151;">
              <span>ğŸ“ Left Position</span>
              <span id="nt-left-val-{{ section.id }}" style="font-weight: 600; color: #27e1c1;">{{ section.settings.overlay_left }}%</span>
            </label>
            <input type="range" id="nt-left-{{ section.id }}" min="0" max="90" step="0.5" value="{{ section.settings.overlay_left }}" style="width: 100%; height: 6px; background: #e5e7eb; border-radius: 3px; outline: none; cursor: pointer;">
          </div>

          <!-- Width -->
          <div class="placement-slider">
            <label style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; color: #374151;">
              <span>ğŸ“ Design Width</span>
              <span id="nt-width-val-{{ section.id }}" style="font-weight: 600; color: #27e1c1;">{{ section.settings.overlay_width }}%</span>
            </label>
            <input type="range" id="nt-width-{{ section.id }}" min="10" max="100" step="1" value="{{ section.settings.overlay_width }}" style="width: 100%; height: 6px; background: #e5e7eb; border-radius: 3px; outline: none; cursor: pointer;">
          </div>

          <!-- Rotation -->
          <div class="placement-slider">
            <label style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; color: #374151;">
              <span>ğŸ”„ Rotation</span>
              <span id="nt-rotate-val-{{ section.id }}" style="font-weight: 600; color: #27e1c1;">{{ section.settings.overlay_rotate }}Â°</span>
            </label>
            <input type="range" id="nt-rotate-{{ section.id }}" min="-45" max="45" step="0.5" value="{{ section.settings.overlay_rotate }}" style="width: 100%; height: 6px; background: #e5e7eb; border-radius: 3px; outline: none; cursor: pointer;">
          </div>
        </div>

        <!-- Placement Guide Controls -->
        <div style="margin-top: 20px; padding: 16px; background: #fef3c7; border-radius: 12px; border: 1px solid #fbbf24;">
          <h5 style="margin: 0 0 12px 0; font-size: 14px; font-weight: 600; color: #92400e;">ğŸ¯ Placement Guide</h5>
          <div style="display: flex; align-items: center; gap: 12px;">
            <button id="nt-toggle-guide-{{ section.id }}" style="padding: 8px 16px; background: linear-gradient(45deg, #f59e0b, #d97706); color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: 500;">
              ğŸ“ Show Placement Guide
            </button>
            <span style="font-size: 12px; color: #92400e;">Toggle crosshairs and placement area</span>
          </div>
        </div>

        <!-- Mockup Size Controls -->
        <div style="margin-top: 20px; padding: 16px; background: #f0fdf4; border-radius: 12px; border: 1px solid #bbf7d0;">
          <h5 style="margin: 0 0 12px 0; font-size: 14px; font-weight: 600; color: #166534;">ğŸ” Mockup Size Controls</h5>
          <div style="display: grid; grid-template-columns: 1fr auto; gap: 12px; align-items: end;">
            <div>
              <label style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; color: #374151;">
                <span>ğŸ“ T-shirt Scale</span>
                <span id="nt-mockup-scale-val-{{ section.id }}" style="font-weight: 600; color: #27e1c1;">100%</span>
              </label>
              <input type="range" id="nt-mockup-scale-{{ section.id }}" min="50" max="130" step="5" value="100" style="width: 100%; height: 6px; background: #e5e7eb; border-radius: 3px; outline: none; cursor: pointer;">
            </div>
            <div style="display: flex; flex-direction: column; gap: 6px;">
              <button id="nt-zoom-in-{{ section.id }}" style="padding: 8px 12px; background: #4299e1; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: 500;">ğŸ” Zoom In</button>
              <button id="nt-zoom-out-{{ section.id }}" style="padding: 8px 12px; background: #ed8936; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: 500;">ğŸ” Zoom Out</button>
            </div>
          </div>
        </div>

        <!-- Design Size Presets -->
        <div style="margin-top: 20px; padding: 16px; background: #fef3c7; border-radius: 12px; border: 1px solid #fbbf24;">
          <h5 style="margin: 0 0 12px 0; font-size: 14px; font-weight: 600; color: #92400e;">âš¡ Quick Size Presets</h5>
          <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 12px;">
            <button class="size-preset" data-size="25" style="padding: 8px 12px; background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: 500; transition: all 0.2s ease;">25%</button>
            <button class="size-preset" data-size="50" style="padding: 8px 12px; background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: 500; transition: all 0.2s ease;">50%</button>
            <button class="size-preset" data-size="75" style="padding: 8px 12px; background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: 500; transition: all 0.2s ease;">75%</button>
            <button class="size-preset" data-size="100" style="padding: 8px 12px; background: #f3f4f6; color: #374151; border: 1px solid #d1d5db; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: 500; transition: all 0.2s ease;">100%</button>
          </div>
          <div style="display: flex; gap: 8px; align-items: center;">
            <button id="nt-reset-size-{{ section.id }}" style="padding: 6px 12px; background: #6b7280; color: white; border: none; border-radius: 4px; font-size: 11px; cursor: pointer; font-weight: 500;">ğŸ”„ Reset</button>
            <span style="font-size: 11px; color: #6b7280;">Double-click design to reset size</span>
          </div>
        </div>

        <div style="margin-top: 16px; padding: 12px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
          <div style="font-size: 12px; color: #6b7280; text-align: center; line-height: 1.4;">
            ğŸ’¡ <strong>Pro Tips:</strong><br>
            â€¢ Drag design to move â€¢ Scroll wheel to resize â€¢ Ctrl+scroll for precise control<br>
            â€¢ Shift+scroll for large steps â€¢ Double-click to reset â€¢ Use keyboard arrows for fine control<br>
            â€¢ Ctrl+1/2/3/4 for quick presets (25%, 50%, 75%, 100%)
          </div>
        </div>
      </div>

      <!-- Enhanced Preview Stage -->
        <div class="nt-mockup__stage" style="width: 100%; display: grid; place-items: center; margin-top: 60px !important; margin-bottom: 100px !important; padding: 0 20px;">
          <div class="nt-mockup__canvas" 
               id="nt-mockup-canvas-{{ section.id }}"
               style="position: relative; width: min(900px, 100%); max-width: 90vw; aspect-ratio: 1 / 1; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px; overflow: hidden; box-shadow: 0 25px 80px rgba(102, 126, 234, 0.3), 0 10px 30px rgba(0,0,0,0.2); cursor: grab; --overlay-top: 45%; --overlay-left: 25%; --overlay-width: 60%; --overlay-rotate: 0deg;">
          
      <!-- Base Mockup (swapped by JS) -->
      <img
        id="nt-base-{{ section.id }}"
        class="nt-mockup__base"
        src="{{ 'WFront_t-shirt.png' | asset_url }}"
        alt="T-shirt mockup"
        loading="eager"
        decoding="async"
        style="position: absolute; inset: 0; width: 100%; height: 100%; object-fit: contain; pointer-events: none;"
        onerror="console.error('âŒ Failed to load t-shirt image:', this.src);"
        onload="console.log('âœ… T-shirt image loaded:', this.src);"
      >
          
          <!-- Debug: Test direct asset access -->
          <div id="debug-assets-{{ section.id }}" style="position: absolute; top: -100px; left: -100px; width: 1px; height: 1px; overflow: hidden;">
            <img src="{{ 'WFront_t-shirt.png' | asset_url }}" onload="console.log('âœ… Direct asset test - WFront_t-shirt.png loaded:', this.src);" onerror="console.error('âŒ Direct asset test - WFront_t-shirt.png failed:', this.src);">
            <img src="{{ 'Wback_t-shirt.png' | asset_url }}" onload="console.log('âœ… Direct asset test - Wback_t-shirt.png loaded:', this.src);" onerror="console.error('âŒ Direct asset test - Wback_t-shirt.png failed:', this.src);">
            <img src="{{ 'Models/Women/Girl-Model.png' | asset_url }}" onload="console.log('âœ… Direct asset test - Girl-Model.png loaded:', this.src);" onerror="console.error('âŒ Direct asset test - Girl-Model.png failed:', this.src);">
          </div>
          
          <!-- Dynamic Design Overlay -->
          <div
            id="nt-overlay-{{ section.id }}"
            class="nt-mockup__overlay"
            style="position: absolute; width: var(--overlay-width); left: var(--overlay-left); top: var(--overlay-top); transform: rotate(var(--overlay-rotate)); height: auto; inset: auto; display: flex; align-items: center; justify-content: center; cursor: grab; transition: all 0.1s ease; border: 2px dashed rgba(39, 225, 193, 0.3); border-radius: 8px; background: rgba(39, 225, 193, 0.05);"
          >
            <span id="nt-design-text-{{ section.id }}" 
                  style="font-family: 'Bebas Neue', sans-serif; font-size: 32px; font-weight: bold; color: #000000; text-align: center; white-space: nowrap; user-select: none; text-shadow: 1px 1px 2px rgba(255,255,255,0.8); pointer-events: none;">
              Your Design Here
            </span>
            
            <!-- Drag Handle (only visible when dragging) -->
            <div id="nt-drag-handle-{{ section.id }}" 
                 style="position: absolute; top: -8px; right: -8px; width: 16px; height: 16px; background: #27e1c1; border: 2px solid white; border-radius: 50%; cursor: grab; display: none; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
            </div>
            
            <!-- Resize Handles - All Directions (Hidden by default, shown when selected) -->
            <!-- Top-Left -->
            <div class="resize-handle" data-direction="nw" 
                 style="position: absolute; top: -12px; left: -12px; width: 24px; height: 24px; background: #ff6b6b; border: 3px solid white; border-radius: 50%; cursor: nw-resize; display: none; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10; touch-action: none;"
                 title="Resize from top-left">
            </div>
            
            <!-- Top-Right -->
            <div class="resize-handle" data-direction="ne" 
                 style="position: absolute; top: -12px; right: -12px; width: 24px; height: 24px; background: #ff6b6b; border: 3px solid white; border-radius: 50%; cursor: ne-resize; display: none; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10; touch-action: none;"
                 title="Resize from top-right">
            </div>
            
            <!-- Bottom-Left -->
            <div class="resize-handle" data-direction="sw" 
                 style="position: absolute; bottom: -12px; left: -12px; width: 24px; height: 24px; background: #ff6b6b; border: 3px solid white; border-radius: 50%; cursor: sw-resize; display: none; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10; touch-action: none;"
                 title="Resize from bottom-left">
            </div>
            
            <!-- Bottom-Right -->
            <div class="resize-handle" data-direction="se" 
                 style="position: absolute; bottom: -12px; right: -12px; width: 24px; height: 24px; background: #ff6b6b; border: 3px solid white; border-radius: 50%; cursor: se-resize; display: none; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10; touch-action: none;"
                 title="Resize from bottom-right">
            </div>
            
            <!-- Side Handles (Hidden by default, shown when selected) -->
            <!-- Top -->
            <div class="resize-handle" data-direction="n" 
                 style="position: absolute; top: -12px; left: 50%; transform: translateX(-50%); width: 24px; height: 24px; background: #4ecdc4; border: 3px solid white; border-radius: 50%; cursor: n-resize; display: none; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10; touch-action: none;"
                 title="Resize from top">
            </div>
            
            <!-- Bottom -->
            <div class="resize-handle" data-direction="s" 
                 style="position: absolute; bottom: -12px; left: 50%; transform: translateX(-50%); width: 24px; height: 24px; background: #4ecdc4; border: 3px solid white; border-radius: 50%; cursor: s-resize; display: none; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10; touch-action: none;"
                 title="Resize from bottom">
            </div>
            
            <!-- Left -->
            <div class="resize-handle" data-direction="w" 
                 style="position: absolute; left: -12px; top: 50%; transform: translateY(-50%); width: 24px; height: 24px; background: #4ecdc4; border: 3px solid white; border-radius: 50%; cursor: w-resize; display: none; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10; touch-action: none;"
                 title="Resize from left">
            </div>
            
            <!-- Right -->
            <div class="resize-handle" data-direction="e" 
                 style="position: absolute; right: -12px; top: 50%; transform: translateY(-50%); width: 24px; height: 24px; background: #4ecdc4; border: 3px solid white; border-radius: 50%; cursor: e-resize; display: none; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10; touch-action: none;"
                 title="Resize from right">
            </div>
            
          </div>
          
          <!-- Interactive Placement Guide (positioned above design when active) -->
          <div id="nt-placement-guide-{{ section.id }}" 
               style="position: absolute; inset: 0; pointer-events: none; z-index: 6; display: none;">
            
            <!-- Crosshairs with better visibility -->
            <div style="position: absolute; top: 50%; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, #ff6b6b, #ff6b6b, transparent); transform: translateY(-50%); box-shadow: 0 0 4px rgba(255, 107, 107, 0.5);"></div>
            <div style="position: absolute; left: 50%; top: 0; bottom: 0; width: 2px; background: linear-gradient(180deg, transparent, #ff6b6b, #ff6b6b, transparent); transform: translateX(-50%); box-shadow: 0 0 4px rgba(255, 107, 107, 0.5);"></div>
            
            <!-- Center circle with better visibility -->
            <div style="position: absolute; top: 50%; left: 50%; width: 24px; height: 24px; border: 3px solid #ff6b6b; border-radius: 50%; transform: translate(-50%, -50%); background: rgba(255, 107, 107, 0.2); box-shadow: 0 0 8px rgba(255, 107, 107, 0.6);"></div>
            
            <!-- Placement area indicator with better styling -->
            <div style="position: absolute; top: 20%; left: 20%; right: 20%; bottom: 20%; border: 3px dashed #4ecdc4; border-radius: 12px; background: rgba(78, 205, 196, 0.1); box-shadow: 0 0 12px rgba(78, 205, 196, 0.3);">
              <div style="position: absolute; top: 8px; left: 50%; transform: translateX(-50%); background: linear-gradient(45deg, #4ecdc4, #44a08d); color: white; padding: 6px 16px; border-radius: 8px; font-size: 13px; font-weight: 700; white-space: nowrap; box-shadow: 0 2px 8px rgba(0,0,0,0.3);">
                ğŸ¯ Place Design Here
              </div>
            </div>
            
            <!-- Corner guides with better visibility -->
            <div style="position: absolute; top: 15%; left: 15%; width: 12px; height: 12px; border: 2px solid #4ecdc4; border-radius: 50%; background: rgba(78, 205, 196, 0.3); box-shadow: 0 0 6px rgba(78, 205, 196, 0.5);"></div>
            <div style="position: absolute; top: 15%; right: 15%; width: 12px; height: 12px; border: 2px solid #4ecdc4; border-radius: 50%; background: rgba(78, 205, 196, 0.3); box-shadow: 0 0 6px rgba(78, 205, 196, 0.5);"></div>
            <div style="position: absolute; bottom: 15%; left: 15%; width: 12px; height: 12px; border: 2px solid #4ecdc4; border-radius: 50%; background: rgba(78, 205, 196, 0.3); box-shadow: 0 0 6px rgba(78, 205, 196, 0.5);"></div>
            <div style="position: absolute; bottom: 15%; right: 15%; width: 12px; height: 12px; border: 2px solid #4ecdc4; border-radius: 50%; background: rgba(78, 205, 196, 0.3); box-shadow: 0 0 6px rgba(78, 205, 196, 0.5);"></div>
            
            <!-- Smart Centering Indicators -->
            <div id="nt-centering-indicators-{{ section.id }}" style="position: absolute; inset: 0; pointer-events: none;">
              
              <!-- Perfect Center Indicator -->
              <div id="nt-perfect-center-{{ section.id }}" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: none;">
                <div style="width: 40px; height: 40px; border: 3px solid #10b981; border-radius: 50%; background: rgba(16, 185, 129, 0.2); box-shadow: 0 0 20px rgba(16, 185, 129, 0.8); animation: pulse 2s infinite;">
                  <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #10b981; font-size: 16px; font-weight: bold;">âœ“</div>
                </div>
                <div style="position: absolute; top: -25px; left: 50%; transform: translateX(-50%); background: #10b981; color: white; padding: 4px 8px; border-radius: 4px; font-size: 10px; font-weight: 600; white-space: nowrap;">
                  PERFECT CENTER
                </div>
              </div>
              
              <!-- Horizontal Center Indicator -->
              <div id="nt-horizontal-center-{{ section.id }}" style="position: absolute; top: 50%; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, #f59e0b, #f59e0b, transparent); transform: translateY(-50%); display: none; box-shadow: 0 0 8px rgba(245, 158, 11, 0.6);"></div>
              
              <!-- Vertical Center Indicator -->
              <div id="nt-vertical-center-{{ section.id }}" style="position: absolute; left: 50%; top: 0; bottom: 0; width: 2px; background: linear-gradient(180deg, transparent, #f59e0b, #f59e0b, transparent); transform: translateX(-50%); display: none; box-shadow: 0 0 8px rgba(245, 158, 11, 0.6);"></div>
              
              <!-- Equidistant Indicators -->
              <div id="nt-equidistant-{{ section.id }}" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: none;">
                <div style="width: 60px; height: 60px; border: 2px dashed #8b5cf6; border-radius: 50%; background: rgba(139, 92, 246, 0.1); box-shadow: 0 0 15px rgba(139, 92, 246, 0.4);">
                  <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #8b5cf6; font-size: 14px; font-weight: bold;">âš–</div>
                </div>
                <div style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); background: #8b5cf6; color: white; padding: 3px 6px; border-radius: 3px; font-size: 9px; font-weight: 600; white-space: nowrap;">
                  EQUIDISTANT
                </div>
              </div>
              
              <!-- Status Messages -->
              <div id="nt-centering-status-{{ section.id }}" style="position: absolute; top: 10px; left: 10px; background: rgba(0, 0, 0, 0.8); color: white; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 600; display: none; max-width: 200px;">
                <div id="nt-status-text-{{ section.id }}"></div>
              </div>
            </div>
          </div>

            <!-- Resize Handle (only visible when design is selected) -->
            <div id="nt-resize-handle-{{ section.id }}" 
                 style="position: absolute; bottom: -8px; right: -8px; width: 20px; height: 20px; background: #8b5cf6; border: 2px solid white; border-radius: 50%; cursor: nw-resize; display: none; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
              <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 8px; height: 8px; border-right: 2px solid white; border-bottom: 2px solid white; transform: translate(-50%, -50%) rotate(45deg);"></div>
            </div>
        </div>
        
        <p class="nt-mockup__hint" style="color: #6b7280; font-size: 14px; margin-top: 16px; text-align: center;">
          ğŸ’¡ Tip: Drag the design to move it, use scroll wheel to resize, or use the precise controls above
        </p>
      </div>
    </div>
  </div>
</section>

<style>
/* Enhanced Button Styles */
.nt-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.nt-btn--view:hover:not(.is-active),
.nt-btn--color:hover:not(.is-active) {
  border-color: #27e1c1 !important;
  background: #f0fdfa !important;
  color: #27e1c1 !important;
}

.nt-btn--primary:hover {
  background: linear-gradient(45deg, #059669, #047857) !important;
  box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
}

.nt-btn--secondary:hover {
  background: linear-gradient(45deg, #a855f7, #9333ea) !important;
  box-shadow: 0 8px 25px rgba(139, 92, 246, 0.3);
}

.nt-btn--upload:hover {
  background: linear-gradient(45deg, #d97706, #b45309) !important;
  box-shadow: 0 8px 25px rgba(245, 158, 11, 0.3);
}

.file-type:hover {
  background: #d1d5db !important;
}

.help-link:hover {
  color: #1d4ed8 !important;
}

/* Enhanced Interactive Styles */
.nt-mockup__overlay:hover {
  cursor: grab !important;
}

.nt-mockup__overlay:active {
  cursor: grabbing !important;
}

.nt-mockup__canvas.dragging {
  cursor: grabbing !important;
}

/* Design Selection Styles */
.nt-mockup__overlay.design-selected {
  border-color: #27e1c1 !important;
  box-shadow: 0 0 0 3px rgba(39, 225, 193, 0.3) !important;
}

.nt-mockup__overlay.design-selected:hover {
  cursor: grab !important;
  border-color: #27e1c1 !important;
  box-shadow: 0 0 0 3px rgba(39, 225, 193, 0.4) !important;
}

/* Resize Handle Animations */
.resize-handle {
  transition: all 0.2s ease;
  display: none !important; /* Force hide by default */
}

.resize-handle:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 16px rgba(0,0,0,0.4) !important;
}

/* Show handles only when explicitly set to block */
.resize-handle.show-handle {
  display: block !important;
}


.nt-placement-controls {
  animation: slideInUp 0.3s ease;
}

@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulse {
  0%, 100% { 
    transform: translate(-50%, -50%) scale(1); 
    opacity: 1; 
  }
  50% { 
    transform: translate(-50%, -50%) scale(1.1); 
    opacity: 0.8; 
  }
}

.placement-slider input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  background: transparent;
  cursor: pointer;
}

.placement-slider input[type="range"]::-webkit-slider-track {
  background: #e5e7eb;
  height: 6px;
  border-radius: 3px;
}

.placement-slider input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  background: #27e1c1;
  height: 18px;
  width: 18px;
  border-radius: 50%;
  border: 2px solid white;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  cursor: pointer;
}

.placement-slider input[type="range"]::-moz-range-track {
  background: #e5e7eb;
  height: 6px;
  border-radius: 3px;
  border: none;
}

.placement-slider input[type="range"]::-moz-range-thumb {
  background: #27e1c1;
  height: 18px;
  width: 18px;
  border-radius: 50%;
  border: 2px solid white;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  cursor: pointer;
}

/* Responsive Design */
@media (max-width: 768px) {
  .nt-mockup__controls {
    flex-direction: column !important;
    gap: 15px !important;
  }
  
  .nt-mockup__group {
    flex-direction: column !important;
    gap: 8px !important;
  }
  
  .nt-mockup__buttons {
    flex-wrap: wrap !important;
    justify-content: center !important;
  }
  
  .mockup-header h2 {
    font-size: 32px !important;
  }
  
  .nt-mockup__canvas {
    width: 100% !important;
    max-width: 500px !important;
  }

  .nt-placement-controls {
    margin: 10px 0 !important;
    padding: 16px !important;
  }

  .placement-slider {
    margin-bottom: 12px !important;
  }
}

/* Animation Classes */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.mockup-header {
  animation: fadeInUp 0.6s ease;
}

.nt-mockup__controls {
  animation: fadeInUp 0.8s ease;
}

.nt-mockup__stage {
  animation: fadeInUp 1s ease;
}
</style>

<script src="{{ 'interactive-mockup.js' | asset_url }}"></script>

{% schema %}
{
  "name": "Interactive Mockup",
  "class": "section-interactive-mockup",
  "settings": [
    {
      "type": "header",
      "content": "ğŸ–¼ Base T-shirt Mockup"
    },
    {
      "type": "image_picker",
      "id": "base_mockup",
      "label": "Base T-shirt Image",
      "info": "Upload a high-quality T-shirt mockup image. Recommended size: 800x800px or larger."
    },
    {
      "type": "header",
      "content": "ğŸ“ Design Overlay Settings"
    },
    {
      "type": "range",
      "id": "overlay_top",
      "min": 0,
      "max": 90,
      "step": 1,
      "unit": "%",
      "label": "Top Position",
      "default": 45
    },
    {
      "type": "range",
      "id": "overlay_left",
      "min": 0,
      "max": 90,
      "step": 1,
      "unit": "%",
      "label": "Left Position",
      "default": 25
    },
    {
      "type": "range",
      "id": "overlay_width",
      "min": 10,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Design Width",
      "default": 60
    },
    {
      "type": "range",
      "id": "overlay_rotate",
      "min": -45,
      "max": 45,
      "step": 1,
      "unit": "Â°",
      "label": "Design Rotation",
      "default": 0
    },
    {
      "type": "header",
      "content": "âš™ï¸ Options"
    },
    {
      "type": "checkbox",
      "id": "allow_download",
      "label": "Enable Download Feature",
      "default": true
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Top",
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 40
    }
  ],
  "presets": [
    {
      "name": "Interactive Mockup"
    }
  ]
}
{% endschema %}
